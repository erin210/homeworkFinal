import{r as _,i as R,c,a as t,t as d,d as J,e as K,w as g,v as V,j as h,n as M,F as O,k as I,h as L,b as v,f as y,g as q,o as i,l as E}from"./index-CNSDvB20.js";const Q={id:"todoListPage",class:"bg-half"},W=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),X={class:"todo_sm"},Y={href:"#"},Z={class:"conatiner todoListPage vhContainer"},ee={class:"todoList_Content"},te={class:"inputBox"},oe=t("i",{class:"fa fa-plus"},null,-1),se=[oe],ne={class:"todoList_list"},ae={class:"todoList_tab"},le={key:0,class:"todoList_items"},ce={class:"todoList_item"},ie=["for"],ue=["id","onUpdate:modelValue","onChange"],de={key:1,class:"editBox"},re=["placeholder"],ve=["onClick"],_e=["onClick"],he=["onClick"],pe=t("i",{class:"fas fa-edit"},null,-1),ke=[pe],me=["onClick"],be=t("i",{class:"fa fa-times"},null,-1),ge=[be],ye={key:0,class:"todoList_statistics"},fe=t("br",null,null,-1),Ce=t("br",null,null,-1),$e={key:1,class:"todoList_items"},Le={class:"todoList_item"},Te=["for"],xe=["id","onUpdate:modelValue","onChange"],Ve={key:1,class:"editBox"},we=["placeholder"],Ue=["onClick"],ze=["onClick"],Ae=["onClick"],Be=t("i",{class:"fas fa-edit"},null,-1),Fe=[Be],Ne=["onClick"],De=t("i",{class:"fa fa-times"},null,-1),Me=[De],Oe={key:0,class:"todoList_statistics"},Ie={key:2,class:"todoList_items"},Ee={class:"todoList_item"},Se=["for"],Pe=["id","onUpdate:modelValue","onChange"],Re={key:1,class:"editBox"},je=["placeholder"],Ge=["onClick"],He=["onClick"],Je=["onClick"],Ke=t("i",{class:"fas fa-edit"},null,-1),qe=[Ke],Qe=["onClick"],We=t("i",{class:"fa fa-times"},null,-1),Xe=[We],Ye={key:0,class:"todoList_statistics"},f="https://todolist-api.hexschool.io",ot={__name:"TodoList",setup(Ze){const p=_(null),C=_(""),w=_({nickname:"",uid:""});(async()=>{if(p.value=document.cookie.replace(/(?:(?:^|.*;\s*)customToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),!p.value){console.log("尚未登入！");return}const l=await y.get(`${f}/users/checkout`,{headers:{Authorization:p.value}});w.value=l.data,$()})();const S=_(""),j=async()=>{var l,o;try{const s=await y.post(`${f}/users/sign_out`,{},{headers:{Authorization:p.value}});document.cookie="customToken=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",S.value="您已登出囉！",alert(S.value),w.value.uid="",console.log(s)}catch(s){console.log(s),C.value=((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.message)||"登出失敗"}},k=_([]),m=_(""),$=async()=>{var l,o;try{const s=await y.get(`${f}/todos/`,{headers:{Authorization:p.value}});s.data.status?s.data.data.length===0?(m.value="目前尚無待辦事項",k.value=s.data.data):(m.value="",s.data.data.forEach(e=>{const n=e.createTime,H=new Date(n*1e3).toISOString().slice(0,19).replace("T"," ");e.createTime=H}),k.value=s.data.data):m.value="目前尚無待辦事項"}catch(s){console.log(s),C.value=((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.message)||"抓清單失敗"}};$();const T=_(""),P=_({content:""}),G=async()=>{var l,o;try{P.value.content=T.value;const s=await y.post(`${f}/todos/`,P.value,{headers:{Authorization:p.value}});T.value="",console.log("新增成功",s),$()}catch(s){console.log(s),C.value=((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.message)||"新增失敗"}},U=async(l,o)=>{var s,e;try{const n=await y.patch(`${f}/todos/${l}/toggle`,{status:o},{headers:{Authorization:p.value}});console.log("修改確認",n),$()}catch(n){console.log(n),C.value=((e=(s=n.response)==null?void 0:s.data)==null?void 0:e.message)||"修改確認失敗"}},z=async l=>{var o,s;try{const e=await y.delete(`${f}/todos/${l}`,{headers:{Authorization:p.value}});console.log("刪除成功",e),$(),console.log(k.value)}catch(e){console.log(e),C.value=((s=(o=e.response)==null?void 0:o.data)==null?void 0:s.message)||"刪除失敗"}},u=_(""),r=_(null),A=(l,o)=>{r.value=o,k.value.forEach(s=>{s.id===l&&!u.value==""&&(s.content=u,console.log(s))})},B=()=>{r.value=null},F=async(l,o)=>{var s,e;console.log(u.value);try{u.value===""?r.value=null:(k.value[o].content=u.value,r.value=null,u.value="");const n=await y.put(`${f}/todos/${l}`,{content:k.value[o].content},{headers:{Authorization:p.value}});console.log("修改清單完成",n),$()}catch(n){console.log(n),C.value=((e=(s=n.response)==null?void 0:s.data)==null?void 0:e.message)||"修改清單失敗"}},b=_("taball"),N=l=>{b.value=l},x=R(()=>k.value.filter(l=>l.status===!1)),D=R(()=>k.value.filter(l=>l.status===!0));return console.log(x.value.length),(l,o)=>{const s=q("RouterLink");return i(),c("div",Q,[t("nav",null,[W,t("ul",null,[t("li",X,[t("a",Y,[t("span",null,"Hello!"+d(w.value.nickname)+"!",1)]),J(s,{to:"/",onClick:j},{default:K(()=>[L("登出")]),_:1})])])]),t("div",Z,[t("div",ee,[t("div",te,[g(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":o[0]||(o[0]=e=>T.value=e)},null,512),[[V,T.value]]),t("a",{href:"",onClick:o[1]||(o[1]=h(e=>G(T.value),["prevent"]))},se)]),t("div",ne,[t("ul",ae,[t("li",null,[t("a",{href:"#",class:M({active:b.value==="taball"}),onClick:o[2]||(o[2]=h(e=>N("taball"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:M({active:b.value==="tabnot"}),onClick:o[3]||(o[3]=h(e=>N("tabnot"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:M({active:b.value==="tabok"}),onClick:o[4]||(o[4]=h(e=>N("tabok"),["prevent"]))},"已完成",2)])]),b.value==="taball"?(i(),c("div",le,[t("ul",ce,[(i(!0),c(O,null,I(k.value,(e,n)=>(i(),c("li",{key:e.id},[n!==r.value?(i(),c("label",{key:0,class:"todoList_label",for:e.id},[g(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":a=>e.status=a,onChange:a=>U(e.id)},null,40,ue),[[E,e.status]]),t("span",null,d(e.content),1)],8,ie)):(i(),c("p",de,[g(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=a=>u.value=a),placeholder:e.content},null,8,re),[[V,u.value]]),L(" "+d(u.value)+" ",1),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm mx-2",onClick:a=>B()}," 取消 ",8,ve),t("button",{type:"button",class:"btn btn-outline-primary btn-sm mx-2",onClick:a=>F(e.id,n)}," 儲存 ",8,_e)])),n!==r.value?(i(),c("a",{key:2,href:"",onClick:h(a=>A(e.id,n),["prevent"])},ke,8,he)):v("",!0),n!==r.value?(i(),c("a",{key:3,href:"",onClick:h(a=>z(e.id),["prevent"])},ge,8,me)):v("",!0)]))),128))]),t("p",null,d(m.value),1),m.value?v("",!0):(i(),c("div",ye,[t("p",null,[L(d(D.value.length)+" 個已完成項目 ",1),fe,Ce,L(" "+d(x.value.length)+" 個待完成項目 ",1)])]))])):v("",!0),b.value==="tabnot"?(i(),c("div",$e,[t("ul",Le,[(i(!0),c(O,null,I(x.value,(e,n)=>(i(),c("li",{key:e.id},[n!==r.value?(i(),c("label",{key:0,class:"todoList_label",for:e.id},[g(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":a=>e.status=a,onChange:a=>U(e.id)},null,40,xe),[[E,e.status]]),t("span",null,d(e.content),1)],8,Te)):(i(),c("p",Ve,[g(t("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=a=>u.value=a),placeholder:e.content},null,8,we),[[V,u.value]]),L(" "+d(u.value)+" ",1),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm mx-2",onClick:a=>B()}," 取消 ",8,Ue),t("button",{type:"button",class:"btn btn-outline-primary btn-sm mx-2",onClick:a=>F(e.id,n)}," 儲存 ",8,ze)])),n!==r.value?(i(),c("a",{key:2,href:"",onClick:h(a=>A(e.id,n),["prevent"])},Fe,8,Ae)):v("",!0),n!==r.value?(i(),c("a",{key:3,href:"",onClick:h(a=>z(e.id),["prevent"])},Me,8,Ne)):v("",!0)]))),128))]),t("p",null,d(m.value),1),m.value?v("",!0):(i(),c("div",Oe,[t("p",null,d(x.value.length)+" 個待完成項目",1)]))])):v("",!0),b.value==="tabok"?(i(),c("div",Ie,[t("ul",Ee,[(i(!0),c(O,null,I(D.value,(e,n)=>(i(),c("li",{key:e.id},[n!==r.value?(i(),c("label",{key:0,class:"todoList_label",for:e.id},[g(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":a=>e.status=a,onChange:a=>U(e.id)},null,40,Pe),[[E,e.status]]),t("span",null,d(e.content),1)],8,Se)):(i(),c("p",Re,[g(t("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=a=>u.value=a),placeholder:e.content},null,8,je),[[V,u.value]]),L(" "+d(u.value)+" ",1),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm mx-2",onClick:a=>B()}," 取消 ",8,Ge),t("button",{type:"button",class:"btn btn-outline-primary btn-sm mx-2",onClick:a=>F(e.id,n)}," 儲存 ",8,He)])),n!==r.value?(i(),c("a",{key:2,href:"",onClick:h(a=>A(e.id,n),["prevent"])},qe,8,Je)):v("",!0),n!==r.value?(i(),c("a",{key:3,href:"",onClick:h(a=>z(e.id),["prevent"])},Xe,8,Qe)):v("",!0)]))),128))]),t("p",null,d(m.value),1),m.value?v("",!0):(i(),c("div",Ye,[t("p",null,d(D.value.length)+" 個已完成項目",1)]))])):v("",!0)])])])])}}};export{ot as default};
